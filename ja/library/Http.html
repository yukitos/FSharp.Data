<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>F# Data: HTTP Utilities
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="The F# Data library implements type providers for working with structured file formats (CSV, JSON and XML) and for accessing the WorldBank and Freebase data. It also includes helpers for other data-related tasks.">
    <meta name="author" content="Tomas Petricek; Gustavo Guerra">

    <script src="http://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="http://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">

    <link type="text/css" rel="stylesheet" href="/FSharp.Data/ja/content/style.css" />
    <script type="text/javascript" src="/FSharp.Data/ja/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="http://github.com/fsharp/FSharp.Data">github page</a></li>
          <li><a href="http://fsharp.github.io/FSharp.Charting/">F# Charting</a></li>
          <li><a href="http://bluemountaincapital.github.io/Deedle">Deedle</a></li>
          <li><a href="http://fsharp.github.io/fsharpx/">fsharpx</a></li>
        </ul>
        <h3 class="muted"><a href="/FSharp.Data/ja/index.html">F# Data</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h1>F# Data: HTTP Utilities</h1>

<p>The .NET library provides powerful API for creating and sending HTTP web requests.
There is a simple <code>WebClient</code> type (see <a href="http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx">MSDN</a>) and a more flexible <code>HttpWebRequest</code>
type (see <a href="http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx">MSDN</a>). However, these two types are quite difficult to use if you
want to quickly run a simple HTTP request and specify parameters such as method,
HTTP POST data or additional headers.</p>

<p>The F# Data Library provides a simple <code>Http</code> type with four overloaded methods:
<code>RequestString</code> and <code>AsyncRequestString</code>, that can be used to create a simple request and
perform it synchronously or asynchronously, and <code>Request</code> and it's async companion <code>AsyncRequest</code> if
you want to request binary files or you want to know more about the response like the status code,
the response url, or the returned headers and cookies.</p>

<p>To use the type, we first need to reference the library using <code>#r</code> (in an F# interactive) 
or add reference to a project. The type is located in <code>FSharp.Net</code> namespace:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="prep">#r</span> <span class="s">&quot;</span><span class="s">.</span><span class="s">.</span><span class="s">/</span><span class="s">.</span><span class="s">.</span><span class="s">/</span><span class="s">.</span><span class="s">.</span><span class="s">/</span><span class="s">bin</span><span class="s">/</span><span class="s">FSharp</span><span class="s">.</span><span class="s">Data</span><span class="s">.</span><span class="s">dll</span><span class="s">&quot;</span>
<span class="k">open</span> <span class="i">FSharp</span><span class="o">.</span><span class="i">Net</span></pre>
</td>
</tr>
</table>

<h2>Sending simple requests</h2>

<p>To send a simple HTTP (GET) request that downloads a specified web page, you 
can use <code>Http.RequestString</code> and <code>Http.AsyncRequestString</code> with just a single parameter:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// Download the content of a web site</span>
<span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">Http</span><span class="o">.</span><span class="i">RequestString</span>(<span class="s">&quot;</span><span class="s">http</span><span class="s">:</span><span class="s">/</span><span class="s">/</span><span class="s">tomasp</span><span class="s">.</span><span class="s">net</span><span class="s">&quot;</span>)

<span class="c">// Download web site asynchronously</span>
<span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">async</span> { <span class="k">let!</span> <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">html</span> <span class="o">=</span> <span class="i">Http</span><span class="o">.</span><span class="i">AsyncRequestString</span>(<span class="s">&quot;</span><span class="s">http</span><span class="s">:</span><span class="s">/</span><span class="s">/</span><span class="s">tomasp</span><span class="s">.</span><span class="s">net</span><span class="s">&quot;</span>)
        <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">%</span><span class="s">d</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs3', 5)" onmouseover="showTip(event, 'fs3', 5)" class="i">html</span><span class="o">.</span><span class="i">Length</span> }
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs5', 6)" onmouseover="showTip(event, 'fs5', 6)" class="i">Async</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs6', 7)" onmouseover="showTip(event, 'fs6', 7)" class="i">Start</span></pre>
</td>
</tr>
</table>

<p>In the rest of the documentation, we focus at the <code>RequestString</code> method, because
the use of <code>AsyncRequestString</code> is exactly the same.</p>

<h2>Query parameters and headers</h2>

<p>You can specify query parameters either by constructing
an URL that includes the parameters (e.g. <code>http://...?test=foo&amp;more=bar</code>) or you
can pass them using the optional parameter <code>query</code>. The following example also explicitly
specifies the GET method, but it will be set automatically for you if you omit it:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="i">Http</span><span class="o">.</span><span class="i">RequestString</span>(<span class="s">&quot;</span><span class="s">http</span><span class="s">:</span><span class="s">/</span><span class="s">/</span><span class="s">httpbin</span><span class="s">.</span><span class="s">org</span><span class="s">/</span><span class="s">get</span><span class="s">&quot;</span>, <span onmouseout="hideTip(event, 'fs7', 8)" onmouseover="showTip(event, 'fs7', 8)" class="i">query</span><span class="o">=</span>[<span class="s">&quot;</span><span class="s">test</span><span class="s">&quot;</span>, <span class="s">&quot;</span><span class="s">foo</span><span class="s">&quot;</span>], <span class="i">meth</span><span class="o">=</span><span class="s">&quot;</span><span class="s">GET</span><span class="s">&quot;</span>)</pre>
</td>
</tr>
</table>

<p>Additional headers are specified similarly - using an optional parameter <code>headers</code>.
The collection can contain custom headers, but also standard headers such as the 
Accept header (which has to be set using a specific property when using <code>HttpWebRequest</code>).</p>

<p>The following example uses <a href="http://www.themoviedb.org">The Movie Database</a> API 
to search for the word "batman". To run the sample, you'll need to register and
provide your API key:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
<span class="l">9: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// API key for http://www.themoviedb.org</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs8', 9)" onmouseover="showTip(event, 'fs8', 9)" class="i">apiKey</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">&lt;</span><span class="s">please</span><span class="s"> </span><span class="s">register</span><span class="s"> </span><span class="s">to</span><span class="s"> </span><span class="s">get</span><span class="s"> </span><span class="s">a</span><span class="s"> </span><span class="s">key</span><span class="s">&gt;</span><span class="s">&quot;</span>

<span class="c">// Run the HTTP web request</span>
<span class="i">Http</span><span class="o">.</span><span class="i">RequestString</span>
  ( <span class="s">&quot;</span><span class="s">http</span><span class="s">:</span><span class="s">/</span><span class="s">/</span><span class="s">api</span><span class="s">.</span><span class="s">themoviedb</span><span class="s">.</span><span class="s">org</span><span class="s">/</span><span class="s">3</span><span class="s">/</span><span class="s">search</span><span class="s">/</span><span class="s">movie</span><span class="s">&quot;</span>,
    <span onmouseout="hideTip(event, 'fs7', 10)" onmouseover="showTip(event, 'fs7', 10)" class="i">query</span>   <span class="o">=</span> [ <span class="s">&quot;</span><span class="s">api_key</span><span class="s">&quot;</span>, <span onmouseout="hideTip(event, 'fs8', 11)" onmouseover="showTip(event, 'fs8', 11)" class="i">apiKey</span>
                <span class="s">&quot;</span><span class="s">query</span><span class="s">&quot;</span>, <span class="s">&quot;</span><span class="s">batman</span><span class="s">&quot;</span> ],
    <span class="i">headers</span> <span class="o">=</span> [ <span class="s">&quot;</span><span class="s">accept</span><span class="s">&quot;</span>, <span class="s">&quot;</span><span class="s">application</span><span class="s">/</span><span class="s">json</span><span class="s">&quot;</span> ])</pre>
</td>
</tr>
</table>

<h2>Sending request data</h2>

<p>If you want to create a POST request with HTTP POST data, you can specify the
additional data in the <code>body</code> optional parameter. This parameter is of type <code>RequestBody</code>, which
is a discriminated union with three cases:</p>

<ul>
<li><code>RequestBody.Text</code> for sending a string in the request body</li>
<li><code>RequestBody.FormValues</code> for sending a set of name-value pairs correspondent to form values</li>
<li><code>RequestBody.Binary</code> for sending binary content in the request</li>
</ul>

<p>If you specify a body, you do not need to set the <code>meth</code> parameter, it will be set to <code>POST</code> automatically.</p>

<p>The following example uses the <a href="http://httpbin.org">httpbin.org</a> service which 
returns the request details:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="i">Http</span><span class="o">.</span><span class="i">RequestString</span>(<span class="s">&quot;</span><span class="s">http</span><span class="s">:</span><span class="s">/</span><span class="s">/</span><span class="s">httpbin</span><span class="s">.</span><span class="s">org</span><span class="s">/</span><span class="s">post</span><span class="s">&quot;</span>, <span class="i">body</span> <span class="o">=</span> <span class="i">RequestBody</span><span class="o">.</span><span class="i">FormValues</span> [<span class="s">&quot;</span><span class="s">test</span><span class="s">&quot;</span>, <span class="s">&quot;</span><span class="s">foo</span><span class="s">&quot;</span>])</pre>
</td>
</tr>
</table>

<p>By default, the <code>Content-Type</code> header is set to <code>text/plain</code>, <code>application/x-www-form-urlencoded</code>,
or <code>application/octet-stream</code>, depending on which kind of <code>RequestBody</code> you specify, but you can change
this behaviour by adding <code>content-type</code> to the list of headers using the optional argument <code>headers</code>:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="i">Http</span><span class="o">.</span><span class="i">RequestString</span>
  ( <span class="s">&quot;</span><span class="s">http</span><span class="s">:</span><span class="s">/</span><span class="s">/</span><span class="s">httpbin</span><span class="s">.</span><span class="s">org</span><span class="s">/</span><span class="s">post</span><span class="s">&quot;</span>, 
    <span class="i">headers</span> <span class="o">=</span> [<span class="s">&quot;</span><span class="s">content</span><span class="s">-</span><span class="s">type</span><span class="s">&quot;</span>, <span class="s">&quot;</span><span class="s">application</span><span class="s">/</span><span class="s">json</span><span class="s">&quot;</span>],
    <span class="i">body</span> <span class="o">=</span> <span class="i">RequestBody</span><span class="o">.</span><span class="i">Text</span> <span class="s">&quot;&quot;&quot;</span><span class="s"> </span><span class="s">{</span><span class="s">&quot;</span><span class="s">test</span><span class="s">&quot;</span><span class="s">:</span><span class="s"> </span><span class="s">42</span><span class="s">}</span><span class="s"> </span><span class="s">&quot;&quot;&quot;</span>)</pre>
</td>
</tr>
</table>

<h2>Maintaing cookies across requests</h2>

<p>If you want to maintain cookies between requests, you can specify the <code>cookieContainer</code> 
parameter. The following example will request the MSDN documentation for the 
<code>HttpRequest</code> class. It will return the code snippets in C# and not F#:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// Build URL with documentation for a given class</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs9', 12)" onmouseover="showTip(event, 'fs9', 12)" class="i">msdnUrl</span> <span onmouseout="hideTip(event, 'fs10', 13)" onmouseover="showTip(event, 'fs10', 13)" class="i">className</span> <span class="o">=</span> 
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs11', 14)" onmouseover="showTip(event, 'fs11', 14)" class="i">root</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">http</span><span class="s">:</span><span class="s">/</span><span class="s">/</span><span class="s">msdn</span><span class="s">.</span><span class="s">microsoft</span><span class="s">.</span><span class="s">com</span><span class="s">&quot;</span>
  <span onmouseout="hideTip(event, 'fs12', 15)" onmouseover="showTip(event, 'fs12', 15)" class="i">sprintf</span> <span class="s">&quot;</span><span class="s">%</span><span class="s">s</span><span class="s">/</span><span class="s">en</span><span class="s">-</span><span class="s">gb</span><span class="s">/</span><span class="s">library</span><span class="s">/</span><span class="s">%</span><span class="s">s</span><span class="s">.</span><span class="s">aspx</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs11', 16)" onmouseover="showTip(event, 'fs11', 16)" class="i">root</span> <span onmouseout="hideTip(event, 'fs10', 17)" onmouseover="showTip(event, 'fs10', 17)" class="i">className</span>

<span class="c">// Get the page and search for F# code</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs13', 18)" onmouseover="showTip(event, 'fs13', 18)" class="i">docInCSharp</span> <span class="o">=</span> <span class="i">Http</span><span class="o">.</span><span class="i">RequestString</span>(<span onmouseout="hideTip(event, 'fs9', 19)" onmouseover="showTip(event, 'fs9', 19)" class="i">msdnUrl</span> <span class="s">&quot;</span><span class="s">system</span><span class="s">.</span><span class="s">web</span><span class="s">.</span><span class="s">httprequest</span><span class="s">&quot;</span>)
<span onmouseout="hideTip(event, 'fs13', 20)" onmouseover="showTip(event, 'fs13', 20)" class="i">docInCSharp</span><span class="o">.</span><span class="i">Contains</span> <span class="s">&quot;</span><span class="s">&lt;</span><span class="s">a</span><span class="s">&gt;</span><span class="s">F</span><span class="s">#</span><span class="s">&lt;</span><span class="s">/</span><span class="s">a</span><span class="s">&gt;</span><span class="s">&quot;</span></pre>
</td>
</tr>
</table>

<p>If we now go to another MSDN page and click on a F# code sample, and then go 
back to the <code>HttpRequest</code> class documentation, while maintaining the same <code>cookieContainer</code>, 
we will be presented with the F# code snippets:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs14', 21)" onmouseover="showTip(event, 'fs14', 21)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs15', 22)" onmouseover="showTip(event, 'fs15', 22)" class="i">Net</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs16', 23)" onmouseover="showTip(event, 'fs16', 23)" class="i">cc</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs17', 24)" onmouseover="showTip(event, 'fs17', 24)" class="i">CookieContainer</span>()

<span class="c">// Send a request to switch the language</span>
<span class="i">Http</span><span class="o">.</span><span class="i">RequestString</span>
  ( <span onmouseout="hideTip(event, 'fs9', 25)" onmouseover="showTip(event, 'fs9', 25)" class="i">msdnUrl</span> <span class="s">&quot;</span><span class="s">system</span><span class="s">.</span><span class="s">datetime</span><span class="s">&quot;</span>, 
    <span onmouseout="hideTip(event, 'fs7', 26)" onmouseover="showTip(event, 'fs7', 26)" class="i">query</span> <span class="o">=</span> [<span class="s">&quot;</span><span class="s">cs</span><span class="s">-</span><span class="s">save</span><span class="s">-</span><span class="s">lang</span><span class="s">&quot;</span>, <span class="s">&quot;</span><span class="s">1</span><span class="s">&quot;</span>; <span class="s">&quot;</span><span class="s">cs</span><span class="s">-</span><span class="s">lang</span><span class="s">&quot;</span>,<span class="s">&quot;</span><span class="s">fsharp</span><span class="s">&quot;</span>], 
    <span class="i">cookieContainer</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs16', 27)" onmouseover="showTip(event, 'fs16', 27)" class="i">cc</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs18', 28)" onmouseover="showTip(event, 'fs18', 28)" class="i">ignore</span>

<span class="c">// Request the documentation again &amp; search for F#</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs19', 29)" onmouseover="showTip(event, 'fs19', 29)" class="i">docInFSharp</span> <span class="o">=</span> 
  <span class="i">Http</span><span class="o">.</span><span class="i">RequestString</span>
    ( <span onmouseout="hideTip(event, 'fs9', 30)" onmouseover="showTip(event, 'fs9', 30)" class="i">msdnUrl</span> <span class="s">&quot;</span><span class="s">system</span><span class="s">.</span><span class="s">web</span><span class="s">.</span><span class="s">httprequest</span><span class="s">&quot;</span>, 
      <span class="i">cookieContainer</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs16', 31)" onmouseover="showTip(event, 'fs16', 31)" class="i">cc</span> )
<span onmouseout="hideTip(event, 'fs19', 32)" onmouseover="showTip(event, 'fs19', 32)" class="i">docInFSharp</span><span class="o">.</span><span class="i">Contains</span> <span class="s">&quot;</span><span class="s">&lt;</span><span class="s">a</span><span class="s">&gt;</span><span class="s">F</span><span class="s">#</span><span class="s">&lt;</span><span class="s">/</span><span class="s">a</span><span class="s">&gt;</span><span class="s">&quot;</span></pre>
</td>
</tr>
</table>

<h2>Getting extra information</h2>

<p>If you want to see more information about the response, including the status code, the response 
headers, the returned cookies, and the response url (which might be different to 
the url you passed when there are redirects), you can use the <code>Request</code> method:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs20', 33)" onmouseover="showTip(event, 'fs20', 33)" class="i">response</span> <span class="o">=</span> <span class="i">Http</span><span class="o">.</span><span class="i">Request</span>(<span onmouseout="hideTip(event, 'fs9', 34)" onmouseover="showTip(event, 'fs9', 34)" class="i">msdnUrl</span> <span class="s">&quot;</span><span class="s">system</span><span class="s">.</span><span class="s">web</span><span class="s">.</span><span class="s">httprequest</span><span class="s">&quot;</span>)

<span class="c">// Examine information about the response</span>
<span onmouseout="hideTip(event, 'fs20', 35)" onmouseover="showTip(event, 'fs20', 35)" class="i">response</span><span class="o">.</span><span class="i">Headers</span>
<span onmouseout="hideTip(event, 'fs20', 36)" onmouseover="showTip(event, 'fs20', 36)" class="i">response</span><span class="o">.</span><span class="i">Cookies</span>
<span onmouseout="hideTip(event, 'fs20', 37)" onmouseover="showTip(event, 'fs20', 37)" class="i">response</span><span class="o">.</span><span class="i">ResponseUrl</span>
<span onmouseout="hideTip(event, 'fs20', 38)" onmouseover="showTip(event, 'fs20', 38)" class="i">response</span><span class="o">.</span><span class="i">StatusCode</span></pre>
</td>
</tr>
</table>

<h2>Requesting binary data</h2>

<p>The <code>RequestString</code> method will always return the response as a <code>string</code>, but if you use the 
<code>Request</code> method, it will return a <code>ResponseBody.Text</code> or a 
<code>ResponseBody.Binary</code> depending on the response <code>content-type</code> header:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs21', 39)" onmouseover="showTip(event, 'fs21', 39)" class="i">logoUrl</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">https</span><span class="s">:</span><span class="s">/</span><span class="s">/</span><span class="s">raw</span><span class="s">.</span><span class="s">github</span><span class="s">.</span><span class="s">com</span><span class="s">/</span><span class="s">fsharp</span><span class="s">/</span><span class="s">FSharp</span><span class="s">.</span><span class="s">Data</span><span class="s">/</span><span class="s">master</span><span class="s">/</span><span class="s">misc</span><span class="s">/</span><span class="s">logo</span><span class="s">.</span><span class="s">png</span><span class="s">&quot;</span>
<span class="k">match</span> <span class="i">Http</span><span class="o">.</span><span class="i">Request</span>(<span onmouseout="hideTip(event, 'fs21', 40)" onmouseover="showTip(event, 'fs21', 40)" class="i">logoUrl</span>)<span class="o">.</span><span class="i">Body</span> <span class="k">with</span>
| <span class="i">ResponseBody</span><span class="o">.</span><span class="i">Text</span> <span class="i">text</span> <span class="k">-&gt;</span> 
    <span onmouseout="hideTip(event, 'fs4', 41)" onmouseover="showTip(event, 'fs4', 41)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">Got</span><span class="s"> </span><span class="s">text</span><span class="s"> </span><span class="s">content</span><span class="s">:</span><span class="s"> </span><span class="s">%</span><span class="s">s</span><span class="s">&quot;</span> <span class="i">text</span>
| <span class="i">ResponseBody</span><span class="o">.</span><span class="i">Binary</span> <span class="i">bytes</span> <span class="k">-&gt;</span> 
    <span onmouseout="hideTip(event, 'fs4', 42)" onmouseover="showTip(event, 'fs4', 42)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">Got</span><span class="s"> </span><span class="s">%</span><span class="s">d</span><span class="s"> </span><span class="s">bytes</span><span class="s"> </span><span class="s">of</span><span class="s"> </span><span class="s">binary</span><span class="s"> </span><span class="s">content</span><span class="s">&quot;</span> <span class="i">bytes</span><span class="o">.</span><span class="i">Length</span></pre>
</td>
</tr>
</table>

<h2>Sending a client certificate</h2>

<p>If you want to add a client certificate to your requests, then you can use the 
optional parameter <code>certificate</code> and pass the <code>X509ClientCertificate</code> value as
an argument. To do that, you need to open the <code>X509Certificates</code> namespace from 
<code>System.Security.Cryptography</code>. Assuming the certificate is stored in <code>myCertificate.pfx</code>,
you can write:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs14', 43)" onmouseover="showTip(event, 'fs14', 43)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 44)" onmouseover="showTip(event, 'fs22', 44)" class="i">Security</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 45)" onmouseover="showTip(event, 'fs23', 45)" class="i">Cryptography</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs24', 46)" onmouseover="showTip(event, 'fs24', 46)" class="i">X509Certificates</span>

<span class="c">// Load the certificate from local file</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs25', 47)" onmouseover="showTip(event, 'fs25', 47)" class="i">clientCert</span> <span class="o">=</span> 
  <span class="k">new</span> <span onmouseout="hideTip(event, 'fs26', 48)" onmouseover="showTip(event, 'fs26', 48)" class="i">X509Certificate2</span>(<span class="s">&quot;</span><span class="s">.</span><span class="s">\</span><span class="s">myCertificate</span><span class="s">.</span><span class="s">pfx</span><span class="s">&quot;</span>, <span class="s">&quot;</span><span class="s">password</span><span class="s">&quot;</span>)

<span class="c">// Send the request with certificate</span>
<span class="i">Http</span><span class="o">.</span><span class="i">Request</span>
  ( <span class="s">&quot;</span><span class="s">http</span><span class="s">:</span><span class="s">/</span><span class="s">/</span><span class="s">yourprotectedresouce</span><span class="s">.</span><span class="s">com</span><span class="s">/</span><span class="s">data</span><span class="s">&quot;</span>,
    <span class="i">certificate</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs25', 49)" onmouseover="showTip(event, 'fs25', 49)" class="i">clientCert</span>)</pre>
</td>
</tr>
</table>

<div class="tip" id="fs1">module Http</div>
<div class="tip" id="fs2">val async : AsyncBuilder<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.async</div>
<div class="tip" id="fs3">val html : obj</div>
<div class="tip" id="fs4">val printfn : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printfn</div>
<div class="tip" id="fs5">Multiple items<br />type Async&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Control.Async&lt;_&gt;<br /><br />--------------------<br />type Async<br />static member AsBeginEnd : computation:(&#39;Arg -&gt; Async&lt;&#39;T&gt;) -&gt; (&#39;Arg * AsyncCallback * obj -&gt; IAsyncResult) * (IAsyncResult -&gt; &#39;T) * (IAsyncResult -&gt; unit)<br />static member AwaitEvent : event:IEvent&lt;&#39;Del,&#39;T&gt; * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt; (requires delegate and &#39;Del :&gt; Delegate)<br />static member AwaitIAsyncResult : iar:IAsyncResult * ?millisecondsTimeout:int -&gt; Async&lt;bool&gt;<br />static member AwaitTask : task:Task&lt;&#39;T&gt; -&gt; Async&lt;&#39;T&gt;<br />static member AwaitWaitHandle : waitHandle:WaitHandle * ?millisecondsTimeout:int -&gt; Async&lt;bool&gt;<br />static member CancelDefaultToken : unit -&gt; unit<br />static member Catch : computation:Async&lt;&#39;T&gt; -&gt; Async&lt;Choice&lt;&#39;T,exn&gt;&gt;<br />static member FromBeginEnd : beginAction:(AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg:&#39;Arg1 * beginAction:(&#39;Arg1 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg1:&#39;Arg1 * arg2:&#39;Arg2 * beginAction:(&#39;Arg1 * &#39;Arg2 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg1:&#39;Arg1 * arg2:&#39;Arg2 * arg3:&#39;Arg3 * beginAction:(&#39;Arg1 * &#39;Arg2 * &#39;Arg3 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromContinuations : callback:((&#39;T -&gt; unit) * (exn -&gt; unit) * (OperationCanceledException -&gt; unit) -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member Ignore : computation:Async&lt;&#39;T&gt; -&gt; Async&lt;unit&gt;<br />static member OnCancel : interruption:(unit -&gt; unit) -&gt; Async&lt;IDisposable&gt;<br />static member Parallel : computations:seq&lt;Async&lt;&#39;T&gt;&gt; -&gt; Async&lt;&#39;T []&gt;<br />static member RunSynchronously : computation:Async&lt;&#39;T&gt; * ?timeout:int * ?cancellationToken:CancellationToken -&gt; &#39;T<br />static member Sleep : millisecondsDueTime:int -&gt; Async&lt;unit&gt;<br />static member Start : computation:Async&lt;unit&gt; * ?cancellationToken:CancellationToken -&gt; unit<br />static member StartAsTask : computation:Async&lt;&#39;T&gt; * ?taskCreationOptions:TaskCreationOptions * ?cancellationToken:CancellationToken -&gt; Task&lt;&#39;T&gt;<br />static member StartChild : computation:Async&lt;&#39;T&gt; * ?millisecondsTimeout:int -&gt; Async&lt;Async&lt;&#39;T&gt;&gt;<br />static member StartChildAsTask : computation:Async&lt;&#39;T&gt; * ?taskCreationOptions:TaskCreationOptions -&gt; Async&lt;Task&lt;&#39;T&gt;&gt;<br />static member StartImmediate : computation:Async&lt;unit&gt; * ?cancellationToken:CancellationToken -&gt; unit<br />static member StartWithContinuations : computation:Async&lt;&#39;T&gt; * continuation:(&#39;T -&gt; unit) * exceptionContinuation:(exn -&gt; unit) * cancellationContinuation:(OperationCanceledException -&gt; unit) * ?cancellationToken:CancellationToken -&gt; unit<br />static member SwitchToContext : syncContext:SynchronizationContext -&gt; Async&lt;unit&gt;<br />static member SwitchToNewThread : unit -&gt; Async&lt;unit&gt;<br />static member SwitchToThreadPool : unit -&gt; Async&lt;unit&gt;<br />static member TryCancelled : computation:Async&lt;&#39;T&gt; * compensation:(OperationCanceledException -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member CancellationToken : Async&lt;CancellationToken&gt;<br />static member DefaultCancellationToken : CancellationToken<br /><br />Full name: Microsoft.FSharp.Control.Async</div>
<div class="tip" id="fs6">static member Async.Start : computation:Async&lt;unit&gt; * ?cancellationToken:System.Threading.CancellationToken -&gt; unit</div>
<div class="tip" id="fs7">val query : Linq.QueryBuilder<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.query</div>
<div class="tip" id="fs8">val apiKey : string<br /><br />Full name: Http.apiKey</div>
<div class="tip" id="fs9">val msdnUrl : className:string -&gt; string<br /><br />Full name: Http.msdnUrl</div>
<div class="tip" id="fs10">val className : string</div>
<div class="tip" id="fs11">val root : string</div>
<div class="tip" id="fs12">val sprintf : format:Printf.StringFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.sprintf</div>
<div class="tip" id="fs13">val docInCSharp : obj<br /><br />Full name: Http.docInCSharp</div>
<div class="tip" id="fs14">namespace System</div>
<div class="tip" id="fs15">namespace System.Net</div>
<div class="tip" id="fs16">val cc : CookieContainer<br /><br />Full name: Http.cc</div>
<div class="tip" id="fs17">Multiple items<br />type CookieContainer =<br />&#160;&#160;new : unit -&gt; CookieContainer + 2 overloads<br />&#160;&#160;member Add : cookie:Cookie -&gt; unit + 3 overloads<br />&#160;&#160;member Capacity : int with get, set<br />&#160;&#160;member Count : int<br />&#160;&#160;member GetCookieHeader : uri:Uri -&gt; string<br />&#160;&#160;member GetCookies : uri:Uri -&gt; CookieCollection<br />&#160;&#160;member MaxCookieSize : int with get, set<br />&#160;&#160;member PerDomainCapacity : int with get, set<br />&#160;&#160;member SetCookies : uri:Uri * cookieHeader:string -&gt; unit<br />&#160;&#160;static val DefaultCookieLimit : int<br />&#160;&#160;...<br /><br />Full name: System.Net.CookieContainer<br /><br />--------------------<br />CookieContainer() : unit<br />CookieContainer(capacity: int) : unit<br />CookieContainer(capacity: int, perDomainCapacity: int, maxCookieSize: int) : unit</div>
<div class="tip" id="fs18">val ignore : value:&#39;T -&gt; unit<br /><br />Full name: Microsoft.FSharp.Core.Operators.ignore</div>
<div class="tip" id="fs19">val docInFSharp : obj<br /><br />Full name: Http.docInFSharp</div>
<div class="tip" id="fs20">val response : obj<br /><br />Full name: Http.response</div>
<div class="tip" id="fs21">val logoUrl : string<br /><br />Full name: Http.logoUrl</div>
<div class="tip" id="fs22">namespace System.Security</div>
<div class="tip" id="fs23">namespace System.Security.Cryptography</div>
<div class="tip" id="fs24">namespace System.Security.Cryptography.X509Certificates</div>
<div class="tip" id="fs25">val clientCert : X509Certificate2<br /><br />Full name: Http.clientCert</div>
<div class="tip" id="fs26">Multiple items<br />type X509Certificate2 =<br />&#160;&#160;inherit X509Certificate<br />&#160;&#160;new : unit -&gt; X509Certificate2 + 12 overloads<br />&#160;&#160;member Archived : bool with get, set<br />&#160;&#160;member Extensions : X509ExtensionCollection<br />&#160;&#160;member FriendlyName : string with get, set<br />&#160;&#160;member GetNameInfo : nameType:X509NameType * forIssuer:bool -&gt; string<br />&#160;&#160;member HasPrivateKey : bool<br />&#160;&#160;member Import : rawData:byte[] -&gt; unit + 5 overloads<br />&#160;&#160;member IssuerName : X500DistinguishedName<br />&#160;&#160;member NotAfter : DateTime<br />&#160;&#160;member NotBefore : DateTime<br />&#160;&#160;...<br /><br />Full name: System.Security.Cryptography.X509Certificates.X509Certificate2<br /><br />--------------------<br />X509Certificate2() : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(rawData: byte []) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(fileName: string) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(handle: nativeint) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(certificate: X509Certificate) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(rawData: byte [], password: string) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(rawData: byte [], password: System.Security.SecureString) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(fileName: string, password: string) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(fileName: string, password: System.Security.SecureString) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />X509Certificate2(rawData: byte [], password: string, keyStorageFlags: X509KeyStorageFlags) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em></div>

        </div>
        <div class="span3">
          <a href="/FSharp.Data/ja/index.html">
            <img src="/FSharp.Data/ja/images/logo.png" style="width:140px;height:140px;margin:10px 0px 0px 35px;border-style:none;" />
          </a>

          <ul class="nav nav-list" id="menu">
            <li class="nav-header">F# Data</li>
            <li class="divider"></li>
            <li><a href="https://nuget.org/packages/FSharp.Data">NuGet経由でライブラリを取得</a></li>
            <li><a href="http://github.com/fsharp/FSharp.Data">GitHub上のソースコード</a></li>
            <li><a href="http://github.com/fsharp/FSharp.Data/blob/master/LICENSE.md">License (Apache 2.0)</a></li>
            <li><a href="http://github.com/fsharp/FSharp.Data/blob/master/RELEASE_NOTES.md">リリースノート</a></li>
            <li><span>
                <a href="/FSharp.Data/ja/contributing.html">F# Dataに貢献する</a>
                (<a href="/FSharp.Data/ja/../contributing.html">En</a>)
                </span></li>
            
            <li class="nav-header">F# Data ライブラリ</li>
            <li><span>
                <a href="/FSharp.Data/ja/fsharpdata.html">はじめに</a>
                (<a href="/FSharp.Data/ja/fsharpdata.html">En</a>)
                </span></li>
            <li class="divider"></li>
            <li><span>
                <a href="/FSharp.Data/ja/library/JsonProvider.html">JSON 型プロバイダー</a>
                (<a href="/FSharp.Data/ja/library/JsonProvider.html">En</a>)
                </span></li>
            <li><span>
                <a href="/FSharp.Data/ja/library/XmlProvider.html">XML 型プロバイダー</a>
                (<a href="/FSharp.Data/ja/library/XmlProvider.html">En</a>)
                </span></li>
            <li><span>
                <a href="/FSharp.Data/ja/library/CsvProvider.html">CSV 型プロバイダー</a>
                (<a href="/FSharp.Data/ja/library/CsvProvider.html">En</a>)
                </span></li>
            <li><span>
                <a href="/FSharp.Data/ja/library/WorldBank.html">WorldBank プロバイダー</a>
                (<a href="/FSharp.Data/ja/library/WorldBank.html">En</a>)
                </span></li>
            <li><span>
                <a href="/FSharp.Data/ja/library/Freebase.html">Freebase プロバイダー</a>
                (<a href="/FSharp.Data/ja/library/Freebase.html">En</a>)
                </span></li>
            <li class="divider"></li>
            <li><span>
                <a href="/FSharp.Data/ja/library/JsonValue.html">JSON パーサーおよびリーダー</a>
                (<a href="/FSharp.Data/ja/library/JsonValue.html">En</a>)
                </span></li>
            <li><span>
                <a href="/FSharp.Data/ja/library/CsvFile.html">CSV パーサーおよびリーダー</a>
                (<a href="/FSharp.Data/ja/library/CsvFile.html">En</a>)
                </span></li>
            <li><span>
                <a href="/FSharp.Data/ja/library/Http.html">HTTP ユーティリティ</a>
                (<a href="/FSharp.Data/ja/library/Http.html">En</a>)
                </span></li>
            <li><span>
                <a href="/FSharp.Data/ja/reference/index.html">API リファレンス</a>
                (<a href="/FSharp.Data/ja/reference/index.html">En</a>)
                </span></li>

            <li class="nav-header">F# Data 試験用ライブラリ</li>
            <li><span>
                <a href="/FSharp.Data/ja/experimental.html">はじめに</a>
                (<a href="/FSharp.Data/ja/experimental.html">En</a>)
                </span></li>
            <li><span>
                <a href="/FSharp.Data/ja/experimental/ApiaryProvider.html">Apiary 型プロバイダー</a>
                (<a href="/FSharp.Data/ja/experimental/ApiaryProvider.html">En</a>)
                </span></li>

            <li class="nav-header">リファレンス</li>
            <li><span>
                <a href="/FSharp.Data/ja/reference/index.html">API リファレンス</a>
                (<a href="/FSharp.Data/ja/reference/index.html">En</a>)
                </span></li>
          </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/fsharp/FSharp.Data"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>
  </body>
  </html>